<!-- مسیر فایل: UI/Views/DashboardView.xaml -->
<!-- ابتدای کد -->
<UserControl x:Class="TradingJournal.UI.Views.DashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:oxy="http://oxyplot.org/wpf"
             FlowDirection="RightToLeft">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <md:Card Grid.Row="0" Margin="8,8,8,0">
            <Grid Margin="16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0"
                           Text="داشبورد تحلیلی"
                           Style="{StaticResource MaterialDesignHeadline5TextBlock}"
                           VerticalAlignment="Center"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <ComboBox x:Name="PeriodSelector"
                              Width="150"
                              md:HintAssist.Hint="دوره زمانی"
                              Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                              Margin="0,0,16,0">
                        <ComboBoxItem Content="امروز" IsSelected="True"/>
                        <ComboBoxItem Content="این هفته"/>
                        <ComboBoxItem Content="این ماه"/>
                        <ComboBoxItem Content="امسال"/>
                        <ComboBoxItem Content="همه"/>
                    </ComboBox>
                    
                    <Button Click="OnRefresh"
                            Style="{StaticResource MaterialDesignIconButton}"
                            ToolTip="بازخوانی"
                            Margin="0,0,8,0">
                        <md:PackIcon Kind="Refresh"/>
                    </Button>
                    
                    <Button Click="OnCustomizeDashboard"
                            Style="{StaticResource MaterialDesignIconButton}"
                            ToolTip="سفارشی‌سازی">
                        <md:PackIcon Kind="Settings"/>
                    </Button>
                </StackPanel>
            </Grid>
        </md:Card>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" 
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled">
            <Grid Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Statistics Cards Row 1 -->
                <WrapPanel Grid.Row="0" Orientation="Horizontal">
                    <!-- Today Card -->
                    <md:Card Width="280" Height="120" Margin="4">
                        <Grid Margin="16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <md:PackIcon Grid.Column="0"
                                         Kind="CalendarToday"
                                         Width="48" Height="48"
                                         VerticalAlignment="Center"
                                         Foreground="{StaticResource PrimaryHueMidBrush}"
                                         Margin="0,0,16,0"/>
                            
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="امروز" 
                                           Style="{StaticResource MaterialDesignBody2TextBlock}"/>
                                <TextBlock x:Name="TodayTradesCount"
                                           Text="0"
                                           Style="{StaticResource MaterialDesignHeadline4TextBlock}"/>
                                <TextBlock x:Name="TodayProfit"
                                           Text="0"
                                           Foreground="{Binding RelativeSource={RelativeSource Self}, 
                                                        Path=Text, 
                                                        Converter={StaticResource ProfitToColor}}"/>
                            </StackPanel>
                        </Grid>
                    </md:Card>

                    <!-- Week Card -->
                    <md:Card Width="280" Height="120" Margin="4">
                        <Grid Margin="16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <md:PackIcon Grid.Column="0"
                                         Kind="CalendarWeek"
                                         Width="48" Height="48"
                                         VerticalAlignment="Center"
                                         Foreground="{StaticResource SecondaryHueMidBrush}"
                                         Margin="0,0,16,0"/>
                            
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="این هفته"
                                           Style="{StaticResource MaterialDesignBody2TextBlock}"/>
                                <TextBlock x:Name="WeekTradesCount"
                                           Text="0"
                                           Style="{StaticResource MaterialDesignHeadline4TextBlock}"/>
                                <TextBlock x:Name="WeekProfit"
                                           Text="0"
                                           Foreground="{Binding RelativeSource={RelativeSource Self}, 
                                                        Path=Text, 
                                                        Converter={StaticResource ProfitToColor}}"/>
                            </StackPanel>
                        </Grid>
                    </md:Card>

                    <!-- Month Card -->
                    <md:Card Width="280" Height="120" Margin="4">
                        <Grid Margin="16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <md:PackIcon Grid.Column="0"
                                         Kind="CalendarMonth"
                                         Width="48" Height="48"
                                         VerticalAlignment="Center"
                                         Foreground="Orange"
                                         Margin="0,0,16,0"/>
                            
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="این ماه"
                                           Style="{StaticResource MaterialDesignBody2TextBlock}"/>
                                <TextBlock x:Name="MonthTradesCount"
                                           Text="0"
                                           Style="{StaticResource MaterialDesignHeadline4TextBlock}"/>
                                <TextBlock x:Name="MonthProfit"
                                           Text="0"
                                           Foreground="{Binding RelativeSource={RelativeSource Self}, 
                                                        Path=Text, 
                                                        Converter={StaticResource ProfitToColor}}"/>
                            </StackPanel>
                        </Grid>
                    </md:Card>

                    <!-- Total Card -->
                    <md:Card Width="280" Height="120" Margin="4">
                        <Grid Margin="16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <md:PackIcon Grid.Column="0"
                                         Kind="ChartLine"
                                         Width="48" Height="48"
                                         VerticalAlignment="Center"
                                         Foreground="Green"
                                         Margin="0,0,16,0"/>
                            
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="کل"
                                           Style="{StaticResource MaterialDesignBody2TextBlock}"/>
                                <TextBlock x:Name="TotalTradesCount"
                                           Text="0"
                                           Style="{StaticResource MaterialDesignHeadline4TextBlock}"/>
                                <TextBlock x:Name="TotalProfit"
                                           Text="0"
                                           Foreground="{Binding RelativeSource={RelativeSource Self}, 
                                                        Path=Text, 
                                                        Converter={StaticResource ProfitToColor}}"/>
                            </StackPanel>
                        </Grid>
                    </md:Card>
                </WrapPanel>

                <!-- Statistics Cards Row 2 -->
                <WrapPanel Grid.Row="1" Orientation="Horizontal">
                    <!-- Win Rate Card -->
                    <md:Card Width="280" Height="120" Margin="4">
                        <Grid Margin="16">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0"
                                       Text="نرخ برد"
                                       Style="{StaticResource MaterialDesignBody2TextBlock}"/>
                            
                            <Grid Grid.Row="1">
                                <ProgressBar Value="{Binding WinRateValue}"
                                             Height="8"
                                             VerticalAlignment="Center"/>
                                <TextBlock x:Name="WinRate"
                                           Text="0%"
                                           Style="{StaticResource MaterialDesignHeadline5TextBlock}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Grid>
                        </Grid>
                    </md:Card>

                    <!-- Average Profit Card -->
                    <md:Card Width="280" Height="120" Margin="4">
                        <Grid Margin="16">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0"
                                       Text="میانگین سود"
                                       Style="{StaticResource MaterialDesignBody2TextBlock}"/>
                            
                            <TextBlock Grid.Row="1"
                                       x:Name="AverageProfit"
                                       Text="0"
                                       Style="{StaticResource MaterialDesignHeadline5TextBlock}"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"/>
                        </Grid>
                    </md:Card>

                    <!-- Best Trade Card -->
                    <md:Card Width="280" Height="120" Margin="4">
                        <Grid Margin="16">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0"
                                       Text="بهترین معامله"
                                       Style="{StaticResource MaterialDesignBody2TextBlock}"/>
                            
                            <TextBlock Grid.Row="1"
                                       x:Name="BestTrade"
                                       Text="0"
                                       Style="{StaticResource MaterialDesignHeadline5TextBlock}"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       Foreground="Green"/>
                        </Grid>
                    </md:Card>

                    <!-- Worst Trade Card -->
                    <md:Card Width="280" Height="120" Margin="4">
                        <Grid Margin="16">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0"
                                       Text="بدترین معامله"
                                       Style="{StaticResource MaterialDesignBody2TextBlock}"/>
                            
                            <TextBlock Grid.Row="1"
                                       x:Name="WorstTrade"
                                       Text="0"
                                       Style="{StaticResource MaterialDesignHeadline5TextBlock}"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       Foreground="Red"/>
                        </Grid>
                    </md:Card>
                </WrapPanel>

                <!-- Charts Row -->
                <Grid Grid.Row="2" Margin="0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <!-- Profit Chart -->
                    <md:Card Grid.Column="0" Margin="4" Height="400">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0"
                                       Text="روند سود/زیان"
                                       Style="{StaticResource MaterialDesignSubtitle1TextBlock}"
                                       Margin="16,16,16,8"/>
                            
                            <oxy:PlotView Grid.Row="1"
                                          x:Name="ProfitChart"
                                          Margin="16,0,16,16"/>
                        </Grid>
                    </md:Card>

                    <!-- Strategy Performance Chart -->
                    <md:Card Grid.Column="1" Margin="4" Height="400">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0"
                                       Text="عملکرد استراتژی‌ها"
                                       Style="{StaticResource MaterialDesignSubtitle1TextBlock}"
                                       Margin="16,16,16,8"/>
                            
                            <oxy:PlotView Grid.Row="1"
                                          x:Name="StrategyChart"
                                          Margin="16,0,16,16"/>
                        </Grid>
                    </md:Card>
                </Grid>

                <!-- Analysis Row -->
                <Grid Grid.Row="3" Margin="0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <!-- Day Analysis -->
                    <md:Card Grid.Column="0" Margin="4">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0"
                                       Text="تحلیل روزانه"
                                       Style="{StaticResource MaterialDesignSubtitle1TextBlock}"
                                       Margin="16,16,16,8"/>
                            
                            <ScrollViewer Grid.Row="1"
                                          MaxHeight="300"
                                          VerticalScrollBarVisibility="Auto">
                                <StackPanel x:Name="DayAnalysisPanel"
                                            Margin="16,0,16,16"/>
                            </ScrollViewer>
                        </Grid>
                    </md:Card>

                    <!-- Strategy Analysis -->
                    <md:Card Grid.Column="1" Margin="4">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0"
                                       Text="تحلیل استراتژی"
                                       Style="{StaticResource MaterialDesignSubtitle1TextBlock}"
                                       Margin="16,16,16,8"/>
                            
                            <ScrollViewer Grid.Row="1"
                                          MaxHeight="300"
                                          VerticalScrollBarVisibility="Auto">
                                <StackPanel x:Name="StrategyAnalysisPanel"
                                            Margin="16,0,16,16"/>
                            </ScrollViewer>
                        </Grid>
                    </md:Card>

                    <!-- Emotional Analysis -->
                    <md:Card Grid.Column="2" Margin="4">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0"
                                       Text="تحلیل روانشناسی"
                                       Style="{StaticResource MaterialDesignSubtitle1TextBlock}"
                                       Margin="16,16,16,8"/>
                            
                            <ScrollViewer Grid.Row="1"
                                          MaxHeight="300"
                                          VerticalScrollBarVisibility="Auto">
                                <StackPanel x:Name="EmotionalAnalysisPanel"
                                            Margin="16,0,16,16"/>
                            </ScrollViewer>
                        </Grid>
                    </md:Card>
                </Grid>

                <!-- Recent Trades -->
                <md:Card Grid.Row="4" Margin="4,8,4,4">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0"
                                   Text="معاملات اخیر"
                                   Style="{StaticResource MaterialDesignSubtitle1TextBlock}"
                                   Margin="16,16,16,8"/>
                        
                        <DataGrid Grid.Row="1"
                                  x:Name="RecentTradesGrid"
                                  MaxHeight="300"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  Style="{StaticResource MaterialDesignDataGrid}"
                                  Margin="16,0,16,16">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="نماد" Binding="{Binding Symbol}" Width="100"/>
                                <DataGridTextColumn Header="نوع" Binding="{Binding Type}" Width="80"/>
                                <DataGridTextColumn Header="تاریخ" Binding="{Binding EntryDate, StringFormat=yyyy/MM/dd}" Width="100"/>
                                <DataGridTextColumn Header="سود/زیان" Binding="{Binding Profit, StringFormat=N0}" Width="100"/>
                                <DataGridTextColumn Header="استراتژی" Binding="{Binding Strategy}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </md:Card>
            </Grid>
        </ScrollViewer>

        <!-- Progress Bar -->
        <ProgressBar x:Name="ProgressBar"
                     Grid.RowSpan="2"
                     IsIndeterminate="True"
                     VerticalAlignment="Top"
                     Visibility="Collapsed"/>
    </Grid>
</UserControl>
<!-- پایان کد -->