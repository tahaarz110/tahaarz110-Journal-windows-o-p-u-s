<!-- مسیر فایل: UI/Views/FormDesigner.xaml -->
<!-- ابتدای کد -->
<UserControl x:Class="TradingJournal.UI.Views.FormDesigner"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
             FlowDirection="RightToLeft">
    
    <md:Card Margin="16">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Toolbar -->
            <ToolBar Grid.Row="0" Style="{StaticResource MaterialDesignToolBar}">
                <ComboBox x:Name="FormComboBox"
                          ItemsSource="{Binding FormNames}"
                          SelectionChanged="OnFormSelected"
                          Width="200"
                          md:HintAssist.Hint="انتخاب فرم"
                          Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                          Margin="8,0"/>

                <Separator/>
                
                <Button Content="فرم جدید"
                        Click="OnCreateNewForm"
                        Style="{StaticResource MaterialDesignRaisedButton}"
                        Margin="4,0"/>
                
                <Button Content="حذف فرم"
                        Click="OnDeleteForm"
                        Style="{StaticResource MaterialDesignRaisedButton}"
                        md:ButtonAssist.CornerRadius="20"
                        Background="Red"
                        Margin="4,0"/>
                
                <Separator/>
                
                <Button Content="ورود فرم"
                        Click="OnImportForm"
                        Style="{StaticResource MaterialDesignFlatButton}"
                        Margin="4,0"/>
                
                <Button Content="خروجی فرم"
                        Click="OnExportForm"
                        Style="{StaticResource MaterialDesignFlatButton}"
                        Margin="4,0"/>
            </ToolBar>

            <!-- Main Content -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Fields List -->
                <GroupBox Grid.Column="0" Header="فیلدهای فرم" Margin="8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="8">
                            <Button Content="افزودن فیلد"
                                    Click="OnAddField"
                                    Style="{StaticResource MaterialDesignRaisedButton}"
                                    Margin="2,0"/>
                            
                            <Button Content="ویرایش"
                                    Click="OnEditField"
                                    Style="{StaticResource MaterialDesignFlatButton}"
                                    Margin="2,0"/>
                            
                            <Button Content="حذف"
                                    Click="OnDeleteField"
                                    Style="{StaticResource MaterialDesignFlatButton}"
                                    Foreground="Red"
                                    Margin="2,0"/>
                            
                            <Separator Margin="8,0"/>
                            
                            <Button Click="OnMoveUp"
                                    Style="{StaticResource MaterialDesignIconButton}"
                                    ToolTip="انتقال به بالا">
                                <md:PackIcon Kind="ArrowUp"/>
                            </Button>
                            
                            <Button Click="OnMoveDown"
                                    Style="{StaticResource MaterialDesignIconButton}"
                                    ToolTip="انتقال به پایین">
                                <md:PackIcon Kind="ArrowDown"/>
                            </Button>
                        </StackPanel>

                        <DataGrid Grid.Row="1"
                                  x:Name="FieldsDataGrid"
                                  ItemsSource="{Binding Fields}"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  SelectionMode="Single"
                                  Margin="8">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ترتیب" 
                                                    Binding="{Binding Order}" 
                                                    Width="60"/>
                                <DataGridTextColumn Header="نام فیلد" 
                                                    Binding="{Binding Name}" 
                                                    Width="120"/>
                                <DataGridTextColumn Header="برچسب" 
                                                    Binding="{Binding Label}" 
                                                    Width="120"/>
                                <DataGridTextColumn Header="نوع" 
                                                    Binding="{Binding FieldType}" 
                                                    Width="100"/>
                                <DataGridCheckBoxColumn Header="اجباری" 
                                                        Binding="{Binding IsRequired}" 
                                                        Width="60"/>
                                <DataGridTextColumn Header="گروه" 
                                                    Binding="{Binding GroupName}" 
                                                    Width="100"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </GroupBox>

                <!-- Splitter -->
                <GridSplitter Grid.Column="1" 
                              Width="5" 
                              HorizontalAlignment="Center" 
                              VerticalAlignment="Stretch"
                              Background="{StaticResource MaterialDesignDivider}"/>

                <!-- Preview -->
                <GroupBox Grid.Column="2" Header="پیش‌نمایش فرم" Margin="8">
                    <ScrollViewer VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Disabled">
                        <Border x:Name="PreviewContainer"
                                Background="{StaticResource MaterialDesignPaper}"
                                CornerRadius="4"
                                Margin="8"
                                Padding="16"/>
                    </ScrollViewer>
                </GroupBox>
            </Grid>
        </Grid>
    </md:Card>
</UserControl>
<!-- پایان کد -->